var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,i)=>{for(var n in i||(i={}))a.call(i,n)&&l(e,n,i[n]);if(t)for(var n of t(i))s.call(i,n)&&l(e,n,i[n]);return e};import{M as n,f as o,o as c,a3 as r,c as d,w as h,a4 as u,t as p,a5 as v,b as f,F as m,i as g,aa as w,ab as b,ae as T,z as x,y as k,C as y,a as _,n as $,v as S,$ as C,T as A,a9 as V,s as L,d as B,r as E,e as P,a6 as I,g as M,af as O,ad as W,A as z,Z as j,E as q,j as D}from"./vue.3e76d0e4.js";import{e as F,p as H}from"./index.16c626da.js";import{S as N,F as R}from"./element-plus.59d69a7b.js";const Y={key:0,class:"menu-wrapper"},U={props:{nav:{type:Object,required:!0},isNest:{type:Boolean,default:!1}},setup:e=>(n(e),(t,a)=>{const s=o("el-menu-item"),l=o("SidebarItem",!0),i=o("el-submenu");return e.nav.children&&!e.nav.hidden?(c(),r("div",Y,[e.nav.children[0].children&&e.nav.children[0].children.length?(c(),d(i,{key:1,index:e.nav.children[0].path},{title:h((()=>[e.nav.children[0].meta.icon?(c(),r("i",{key:0,class:v([e.nav.children[0].meta.icon,"elIcon"])},null,2)):f("",!0),u("span",null,p(e.nav.children[0].meta.title),1)])),default:h((()=>[(c(!0),r(m,null,g(e.nav.children[0].children,(t=>(c(),r("div",{key:t.path},[t.children&&t.children.length?(c(),d(l,{key:0,index:t.path,"is-nest":!0,nav:t,class:"nest-menu"},null,8,["index","nav"])):f("",!0),t.children||t.hidden?f("",!0):(c(),d(s,{key:1,index:t.path},{title:h((()=>[u("span",null,p(t.meta.title),1)])),default:h((()=>[e.nav.children[0].meta.icon?(c(),r("i",{key:0,class:v([e.nav.children[0].meta.icon,"elIcon"])},null,2)):f("",!0)])),_:2},1032,["index"]))])))),128))])),_:1},8,["index"])):(c(),d(s,{key:0,index:e.nav.children[0].path,class:v({"submenu-title-noDropdown":!e.nav.isNest})},{title:h((()=>[u("span",null,p(e.nav.children[0].meta.title),1)])),default:h((()=>[e.nav.children[0].meta.icon?(c(),r("i",{key:0,class:v([e.nav.children[0].meta.icon,"elIcon"])},null,2)):f("",!0)])),_:1},8,["index","class"]))])):f("",!0)})};w("data-v-50733f38");const X={class:"sidebar-container"},Z={class:"logo-text"};b();const G={setup(e){const t=F(),a=T(),s=x([]),l=k((()=>a.state.app.sidebar.opened)),i=k((()=>!l.value));y((()=>{n()}));const n=()=>{a.state.permission.routes.forEach((e=>{s.push(e)}));for(let e=0;e<s.length;e++)s[e].meta&&s[e].meta.roles&&!s[e].meta.roles.includes(t)&&(s.splice(e,1),e--);p(s)},p=e=>{const t=[];e.forEach((e=>{(e.meta||e.children)&&(t.push(e),e.children&&p(e.children))})),e.length=0,e.push(...t)};return(e,t)=>{const a=o("el-menu"),n=o("el-scrollbar");return c(),r("div",X,[u("div",{class:"logo",onClick:t[0]||(t[0]=t=>e.$router.push("/"))},[_(A,{name:"el-zoom-in-center"},{default:h((()=>[$(u("h1",Z,"乡村振兴",512),[[S,C(l)]])])),_:1})]),_(n,{"wrap-class":"scrollbar-wrapper"},{default:h((()=>[_(a,{router:!0,"default-active":e.$route.path,collapse:C(i),"show-timeout":200,"text-color":"#fff","unique-opened":!0,"background-color":"#4a5a74","active-text-color":"#409EFF"},{default:h((()=>[(c(!0),r(m,null,g(C(s),(e=>(c(),d(U,{key:e.path,index:e.path,nav:e},null,8,["index","nav"])))),128))])),_:1},8,["default-active","collapse"])])),_:1})])}},__scopeId:"data-v-50733f38"};w("data-v-588828b7");const J=[u("path",{d:"M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519a8.84 8.84 0 0 0 0-13.9L142.4 381.9c-5.8-4.6-14.4-.5-14.4 6.9v246.3a8.9 8.9 0 0 0 14.4 7z"},null,-1)];b();const K={props:{isActive:{type:Boolean,default:!1}},emits:["toggleClick"],setup(e,{emit:t}){const a=e,s=()=>{t("toggleClick")};return(e,t)=>(c(),r("div",{class:"pl-15 pr-15",onClick:s},[(c(),r("svg",{class:v([{"is-active":a.isActive},"hamburger"]),viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64"},J,2))]))},__scopeId:"data-v-588828b7"};w("data-v-460e6a7e"),b();w("data-v-323e471b");const Q={class:"right-menu"},ee={class:"avatar-wrapper"},te=["src"],ae=u("i",{class:"el-icon-caret-bottom"},null,-1),se=L("首页"),le=L("修改密码"),ie=L("登出");b();const ne={setup(e){const t=V(),a=T(),s=k((()=>a.state.app.sidebar.opened)),l=k((()=>a.state.user.avatar)),i=()=>{a.dispatch("app/toggleSideBar")},n=()=>{N.warning("请联系管理员")},r=()=>{R.confirm("退出登录","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{a.dispatch("user/logout").then((()=>{t.push("/login")}))})).catch((()=>{}))};return(e,t)=>{const a=o("el-dropdown-item"),p=o("el-dropdown-menu"),v=o("el-dropdown"),f=o("el-menu");return c(),d(f,{class:"navbar",mode:"horizontal"},{default:h((()=>[_(K,{class:"hamburger-container","is-active":C(s),onToggleClick:i},null,8,["is-active"]),u("div",Q,[_(v,{class:"avatar-container right-menu-item"},{dropdown:h((()=>[_(p,null,{default:h((()=>[_(a,{onClick:t[0]||(t[0]=t=>e.$router.push("/"))},{default:h((()=>[se])),_:1}),_(a,{divided:"",onClick:n},{default:h((()=>[le])),_:1}),_(a,{divided:"",onClick:r},{default:h((()=>[ie])),_:1})])),_:1})])),default:h((()=>[u("div",ee,[u("img",{src:C(l)?C(l):"/img/logo.png",class:"user-avatar"},null,8,te),ae])])),_:1})])])),_:1})}},__scopeId:"data-v-323e471b"};const oe=B({name:"ScrollPane",emits:{scroll:null},data:()=>({left:0,tagAndTagSpacing:4}),computed:{scrollWrapper(){return this.$refs.scrollContainer.$refs.wrap}},mounted(){this.scrollWrapper.addEventListener("scroll",this.emitScroll,!0)},beforeUnmount(){this.scrollWrapper.removeEventListener("scroll",this.emitScroll)},methods:{handleScroll(e){const t=e.wheelDelta||40*-e.deltaY,a=this.scrollWrapper;a.scrollLeft=a.scrollLeft+t/4},emitScroll(){this.$emit("scroll")},moveToTarget(e){const t=this.$refs.scrollContainer.$el.offsetWidth,a=this.scrollWrapper,s=document.getElementsByClassName("tags-view-item");let l=null,i=null;if(s.length>0&&(l=s[0],i=s[s.length-1]),l===e)a.scrollLeft=0;else if(i===e)a.scrollLeft=a.scrollWidth-t;else{const l=[...s].findIndex((t=>t===e)),i=s[l-1],n=s[l+1],o=n.offsetLeft+n.offsetWidth+this.tagAndTagSpacing,c=i.offsetLeft-this.tagAndTagSpacing;o>a.scrollLeft+t?a.scrollLeft=o-t:c<a.scrollLeft&&(a.scrollLeft=c)}}}});oe.render=function(e,t,a,s,l,i){const n=o("el-scrollbar");return c(),d(n,{ref:"scrollContainer",vertical:!1,class:"scroll-container",onWheel:P(e.handleScroll,["prevent"])},{default:h((()=>[E(e.$slots,"default")])),_:3},8,["onWheel"])},oe.__scopeId="data-v-3e5640df";const ce=B({components:{ScrollPane:oe},data:()=>({visible:!1,top:0,left:0,selectedTag:{},affixTags:[]}),computed:{visitedViews(){return this.$store.state.tagsView.visitedViews},routes:()=>[]},watch:{$route(e){this.addTags(),this.moveToCurrentTag(e)},visible(e){e?document.body.addEventListener("click",this.closeMenu):document.body.removeEventListener("click",this.closeMenu)}},mounted(){this.initTags(),this.addTags()},methods:{isActive(e){return e.path===this.$route.path},isAffix:e=>e.meta&&e.meta.affix,filterAffixTags(e,t="/"){let a=[];return e.forEach((e=>{if(e.meta&&e.meta.affix){const s=H.resolve(t,e.path);a.push({fullPath:s,path:s,name:e.name,meta:i({},e.meta)})}if(e.children){const t=this.filterAffixTags(e.children,e.path);t.length>=1&&(a=[...a,...t])}})),a},initTags(){const e=this.affixTags=this.filterAffixTags(this.routes);for(const t of e)t.name&&this.$store.dispatch("tagsView/addVisitedView",t)},addTags(){const{name:e}=this.$route;return e&&this.$store.dispatch("tagsView/addView",this.$route),!1},moveToCurrentTag(e){this.$nextTick((()=>{const t=this.visitedViews,a=document.getElementsByClassName("tags-view-item");for(let s=0,l=t.length;s<l;s++)if(t[s].path===e.path){this.$refs.scrollPane.moveToTarget(a[s]),t[s].fullPath!==this.$route.fullPath&&this.$store.dispatch("tagsView/updateVisitedView",this.$route);break}}))},closeSelectedTag(e){this.$store.dispatch("tagsView/delView",e).then((({visitedViews:t})=>{this.isActive(e)&&this.toLastView(t)}))},closeOthersTags(){this.$router.push(this.selectedTag),this.$store.dispatch("tagsView/delOthersViews",this.selectedTag).then((()=>{this.moveToCurrentTag(this.selectedTag)}))},closeAllTags(e){this.$store.dispatch("tagsView/delAllViews").then((({visitedViews:t})=>{this.affixTags.some((t=>t.path===e.path))||this.toLastView(t)}))},toLastView(e){const t=e.slice(-1)[0];t?this.$router.push(t.fullPath):this.$router.push("/")},openMenu(e,t){const a=this.$el.getBoundingClientRect().left,s=this.$el.offsetWidth-105,l=t.clientX-a+15;this.left=l>s?s:l,this.top=t.clientY,this.visible=!0,this.selectedTag=e},closeMenu(){this.visible=!1},handleScroll(){this.closeMenu()}}});w("data-v-5a7ca0a7");const re={id:"tags-view-container",class:"tags-view-container"},de=["onClick"];b(),ce.render=function(e,t,a,s,l,i){const n=o("router-link"),w=o("ScrollPane");return c(),r("div",re,[_(w,{ref:"scrollPane",class:"tags-view-wrapper",onScroll:e.handleScroll},{default:h((()=>[(c(!0),r(m,null,g(e.visitedViews,(t=>(c(),d(n,{key:t.path,to:{path:t.path,query:t.query,fullPath:t.fullPath},class:v([e.isActive(t)?"active":"","tags-view-item"]),onMouseup:P((a=>e.isAffix(t)?"":e.closeSelectedTag(t)),["middle"]),onContextmenu:P((a=>e.openMenu(t,a)),["prevent"])},{default:h((()=>[L(p(t.title)+" ",1),e.isAffix(t)?f("",!0):(c(),r("span",{key:0,class:"el-icon-close",onClick:P((a=>e.closeSelectedTag(t)),["prevent","stop"])},null,8,de))])),_:2},1032,["to","class","onMouseup","onContextmenu"])))),128))])),_:1},8,["onScroll"]),$(u("ul",{style:I({left:e.left+"px",top:e.top+"px"}),class:"contextmenu"},[e.isAffix(e.selectedTag)?f("",!0):(c(),r("li",{key:0,onClick:t[0]||(t[0]=t=>e.closeSelectedTag(e.selectedTag))},"关闭")),u("li",{onClick:t[1]||(t[1]=(...t)=>e.closeOthersTags&&e.closeOthersTags(...t))},"关闭其他"),u("li",{onClick:t[2]||(t[2]=t=>e.closeAllTags(e.selectedTag))},"关闭所有")],4),[[S,e.visible]])])},ce.__scopeId="data-v-5a7ca0a7";const he=B({name:"AppMain"});w("data-v-2b955246");const ue={class:"app-main"};b(),he.render=function(e,t,a,s,l,i){const n=o("router-view");return c(),r("section",ue,[_(n,null,{default:h((({Component:e})=>[_(A,{name:"fade-transform",mode:"out-in"},{default:h((()=>[(c(),d(O,null,[(c(),d(M(e)))],1024))])),_:2},1024)])),_:1})])},he.__scopeId="data-v-2b955246";w("data-v-bbc9396e");const pe={class:"main-container"};b();const ve={setup(e){const t=W(),a=T(),s=k((()=>a.state.app.sidebar.opened)),l=k((()=>a.state.app.sidebar.withoutAnimation)),i=k((()=>a.state.app.device)),n=k((()=>({hideSidebar:!s.value,openSidebar:s.value,withoutAnimation:l.value,mobile:"mobile"===i.value})));z(t,(()=>{"mobile"===i.value&&s.value&&a.dispatch("app/closeSideBar",{withoutAnimation:!1})})),j((()=>{window.addEventListener("resize",p)})),y((()=>{h()&&(a.dispatch("app/toggleDevice","mobile"),a.dispatch("app/closeSideBar",{withoutAnimation:!0}))})),q((()=>{window.removeEventListener("resize",p)}));const o=()=>{a.dispatch("app/closeSideBar",{withoutAnimation:!1})},d=D(992),h=()=>document.body.getBoundingClientRect().width-1<d.value,p=()=>{if(!document.hidden){const e=h();a.dispatch("app/toggleDevice",e?"mobile":"desktop"),e&&a.dispatch("app/closeSideBar",{withoutAnimation:!0})}};return(e,t)=>(c(),r("div",{class:v(["app-wrapper",C(n)])},["mobile"===C(i)&&C(s)?(c(),r("div",{key:0,class:"drawer-bg",onClick:o})):f("",!0),_(G),u("div",pe,[_(ne),_(ce),_(he)])],2))},__scopeId:"data-v-bbc9396e"};export{ve as default};
